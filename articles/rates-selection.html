<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EvoPhylo">
<title>Evolutionary Rates &amp; Selection Strength • EvoPhylo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evolutionary Rates &amp; Selection Strength">
<meta property="og:description" content="EvoPhylo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EvoPhylo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/theory.html">Theoretical background</a>
    <a class="dropdown-item" href="../articles/char-part.html">Character Partitioning</a>
    <a class="dropdown-item" href="../articles/rates-selection.html">Evolutionary Rates &amp; Selection Strength</a>
    <a class="dropdown-item" href="../articles/fbd-params.html">Analyzing FBD Parameters</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tiago-simoes/EvoPhylo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="rates-selection_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="rates-selection_files/kePrint-0.0.1/kePrint.js"></script><link href="rates-selection_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Evolutionary Rates &amp; Selection Strength</h1>
            
            <h4 data-toc-skip class="date">2022-05-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tiago-simoes/EvoPhylo/blob/HEAD/vignettes/rates-selection.Rmd" class="external-link"><code>vignettes/rates-selection.Rmd</code></a></small>
      <div class="d-none name"><code>rates-selection.Rmd</code></div>
    </div>

    
    
<p>This vignette explains how to extract evolutionary rate parameters estimated from relaxed clock Bayesian inference analyses produced by the program <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a>. It also shows how to use evolutionary rate based inference of selection strength (or mode) adapted to clock-based rates, as introduced by <span class="citation">Simões and Pierce (<a href="#ref-sim%C3%B5es2021" role="doc-biblioref">2021</a>)</span>.</p>
<div class="section level2">
<h2 id="evolutionary-rates-statistics-and-plots">Evolutionary Rates Statistics and Plots<a class="anchor" aria-label="anchor" href="#evolutionary-rates-statistics-and-plots"></a>
</h2>
<p>In this section, we will extract evolutionary rate parameters from each node from a Bayesian clock (time-calibrate) summary tree produced by <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a>. The functions below will store them in a data frame, produce summary statistics tables, and create different plots showing how rates are distributed across morphological partitions and clades.</p>
<p>Load the <strong>EvoPhylo</strong> package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tiago-simoes/EvoPhylo" class="external-link">EvoPhylo</a></span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="get-rates-from-the-clock-tree-and-create-a-rate-table">1. Get rates from the clock tree and create a rate table<a class="anchor" aria-label="anchor" href="#get-rates-from-the-clock-tree-and-create-a-rate-table"></a>
</h3>
<p>First, import a Bayesian clock tree using <code>treeio</code>’s function <code>read.mrbayes()</code> (= <code>read.beast()</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import summary tree with three clock partitions produced by </span>
<span class="co">## Mr. Bayes (.t or .tre files) from your local directory</span>
<span class="va">tree3p</span> <span class="op">&lt;-</span> <span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/beast-parser.html" class="external-link">read.mrbayes</a></span><span class="op">(</span><span class="st">"Tree3p.t"</span><span class="op">)</span></code></pre></div>
<p>Below, we use the example tree <code>tree3p</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tree3p</span><span class="op">)</span></code></pre></div>
<p>Subsequently, using <code><a href="../reference/get_clockrate_table.html">get_clockrate_table()</a></code>, users can extract mean or median rate values for each node in the summary tree that were annotated by <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a> when creating the summary tree with <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a> “sumt” command. These mean or median rate values are calculated by <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a> taking into account all trees from the posterior sample. This works for any summary tree produced by <a href="https://nbisweden.github.io/MrBayes/" class="external-link">Mr. Bayes</a>: a majority rule consensus or the fully resolved maximum compatible tree (the latter is used in the examples here).</p>
<p>Please note that analyses must have reached the stationarity phase and independent runs converging for the summary statistics in each node to be meaningful summaries of the posterior sample.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get table of clock rates with summary stats for each node in </span>
<span class="co">## the tree for each relaxed clock partition </span>
<span class="va">rate_table_means_no_clades3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_clockrate_table.html">get_clockrate_table</a></span><span class="op">(</span><span class="va">tree3p</span>, summary <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-the-rate-table">2. Export the rate table<a class="anchor" aria-label="anchor" href="#export-the-rate-table"></a>
</h3>
<p>This is a necessary step to subsequently open the rate table spreadsheet locally (e.g., using Microsoft Office Excel) and customize the table with clade names associated with with each node in the tree for downstream analysis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Export the rate tables</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">rate_table_means_no_clades3</span>, file <span class="op">=</span> <span class="st">"RateTable_Means3.csv"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-tree-node-labels">3. Plot tree node labels<a class="anchor" aria-label="anchor" href="#plot-tree-node-labels"></a>
</h3>
<p>To visualize the node values in the tree, you can use <code><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot tree node labels</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/" class="external-link">ggtree</a></span><span class="op">)</span>
<span class="va">tree_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html" class="external-link">ggtree</a></span><span class="op">(</span><span class="va">tree3p</span>, branch.length <span class="op">=</span> <span class="st">"none"</span>, size <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html" class="external-link">geom_tiplab</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, linesize <span class="op">=</span> <span class="fl">0.01</span>, color <span class="op">=</span> <span class="st">"black"</span>, offset <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, color<span class="op">=</span><span class="st">"purple"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span>
<span class="va">tree_nodes</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Save your plot to your working directory as a PDF</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Tree_nodes.pdf"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-summary-statistics-table-and-plots">4. Get summary statistics table and plots<a class="anchor" aria-label="anchor" href="#get-summary-statistics-table-and-plots"></a>
</h3>
<p>Import the rate table with clade membership (new “clade” column added)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import rate table with clade membership (new "clade" column added) </span>
<span class="co">## from your local directory</span>
<span class="va">rate_table_clades_means3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"RateTable_Means3_Clades.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Below, we use the rate table with clade membership <code>rate_table_clades_means3</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         clade nodes   rates1   rates2   rates3</span>
<span class="co">## 1 Dipnomorpha     1 0.943696 0.981486 1.006164</span>
<span class="co">## 2 Dipnomorpha     2 1.065326 0.772074 0.913194</span>
<span class="co">## 3 Dipnomorpha     3 1.182460 0.656872 0.813618</span>
<span class="co">## 4 Dipnomorpha     4 1.229767 0.523709 0.722519</span>
<span class="co">## 5 Dipnomorpha     5 1.230564 0.517773 0.720479</span>
<span class="co">## 6       Other     6 0.658855 0.717277 0.663950</span></code></pre>
<p>Obtain summary statistics table and plots for each clade by clock using <code><a href="../reference/clockrate_summary.html">clockrate_summary()</a></code>. Supplying a file path to <code>file</code> save the output to that file.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get summary statistics table for each clade by clock </span>
<span class="fu"><a href="../reference/clockrate_summary.html">clockrate_summary</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>,
                  file <span class="op">=</span> <span class="st">"Sum_RateTable_Means3.csv"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Rate table summary statistics
</caption>
<thead><tr>
<th style="text-align:left;">
clade
</th>
<th style="text-align:left;">
clock
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
1.23
</td>
</tr>
<tr>
<td style="text-align:left;">
Elpisostegalia
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1.61
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
1.13
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:right;">
1.80
</td>
<td style="text-align:right;">
1.81
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.87
</td>
</tr>
<tr>
<td style="text-align:left;">
Rhizodontidae
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.89
</td>
</tr>
<tr>
<td style="text-align:left;">
Tristichopteridae
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
1.81
</td>
</tr>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.98
</td>
</tr>
<tr>
<td style="text-align:left;">
Elpisostegalia
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:right;">
1.38
</td>
<td style="text-align:right;">
1.41
</td>
<td style="text-align:right;">
1.42
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.53
</td>
</tr>
<tr>
<td style="text-align:left;">
Rhizodontidae
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.56
</td>
</tr>
<tr>
<td style="text-align:left;">
Tristichopteridae
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
1.35
</td>
</tr>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
1.01
</td>
</tr>
<tr>
<td style="text-align:left;">
Elpisostegalia
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.49
</td>
</tr>
<tr>
<td style="text-align:left;">
Rhizodontidae
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
Tristichopteridae
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="plot-rates-by-clock-partition-and-clade">5. Plot rates by clock partition and clade<a class="anchor" aria-label="anchor" href="#plot-rates-by-clock-partition-and-clade"></a>
</h3>
<p>Plot distributions of rates by clock partition and clade with <code><a href="../reference/clockrate_dens_plot.html">clockrate_dens_plot()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Overlapping plots</span>
<span class="fu"><a href="../reference/clockrate_dens_plot.html">clockrate_dens_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, stack <span class="op">=</span> <span class="cn">FALSE</span>,
                    nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Sometimes using stacked plots provides a better visualization as it avoids overlapping distributions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Stacked plots</span>
<span class="fu"><a href="../reference/clockrate_dens_plot.html">clockrate_dens_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, stack <span class="op">=</span> <span class="cn">TRUE</span>,
                    nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>It is also possible to append extra layers using <code>ggplot2</code> function, such as for changing the color scale. Below, we change the color scale to be the Viridis scale.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Stacked plots with viridis color scale</span>
<span class="fu"><a href="../reference/clockrate_dens_plot.html">clockrate_dens_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, stack <span class="op">=</span> <span class="cn">TRUE</span>,
                    nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="rate-linear-models">6. Rate linear models<a class="anchor" aria-label="anchor" href="#rate-linear-models"></a>
</h3>
<p>We can also plot linear model regressions between rates from two or more clocks with <code><a href="../reference/clockrate_reg_plot.html">clockrate_reg_plot()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot regressions of rates from two clocks</span>
<span class="va">p12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clockrate_reg_plot.html">clockrate_reg_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, clock_x <span class="op">=</span> <span class="fl">1</span>, clock_y <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">p13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clockrate_reg_plot.html">clockrate_reg_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, clock_x <span class="op">=</span> <span class="fl">1</span>, clock_y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">p23</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clockrate_reg_plot.html">clockrate_reg_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, clock_x <span class="op">=</span> <span class="fl">2</span>, clock_y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co">#for combining plots</span>
<span class="va">p12</span> <span class="op">+</span> <span class="va">p13</span> <span class="op">+</span> <span class="va">p23</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Save your plot to your working directory as a PDF</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Plot_regs.pdf"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rates-from-single-clock-analysis">Rates from single clock analysis<a class="anchor" aria-label="anchor" href="#rates-from-single-clock-analysis"></a>
</h3>
<p>You can also explore clock rates for summary trees including a single clock shared among all character partitions (or an unpartitioned analysis):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import summary tree with a single clock partitions produced by </span>
<span class="co">## Mr. Bayes (.t or .tre files) from examples directory</span>
<span class="va">tree1p</span> <span class="op">&lt;-</span> <span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/beast-parser.html" class="external-link">read.mrbayes</a></span><span class="op">(</span><span class="st">"Tree1p.t"</span><span class="op">)</span></code></pre></div>
<p>Below, we use the example tree <code>tree1p</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tree1p</span><span class="op">)</span></code></pre></div>
<p>Then, get table of clock rates with summary stats for each node in the tree for each relaxed clock partition.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rate_table_means_no_clades1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_clockrate_table.html">get_clockrate_table</a></span><span class="op">(</span><span class="va">tree1p</span>, summary <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Export the rate tables</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">rate_table_means_no_clades1</span>, file <span class="op">=</span> <span class="st">"RateTable_Means1.csv"</span><span class="op">)</span>

<span class="co">## Import rate table after adding clade membership (new "clade" column added)</span>
<span class="va">rate_table_clades_means1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"RateTable_Means1_Clades.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rate_table_clades_means1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get summary statistics table for each clade by clock </span>
<span class="fu"><a href="../reference/clockrate_summary.html">clockrate_summary</a></span><span class="op">(</span><span class="va">rate_table_clades_means1</span>,
                  file <span class="op">=</span> <span class="st">"Sum_RateTable_Medians1.csv"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Rate table summary statistics
</caption>
<thead><tr>
<th style="text-align:left;">
clade
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
Q1
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
Q3
</th>
<th style="text-align:right;">
max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.95
</td>
</tr>
<tr>
<td style="text-align:left;">
Elpisostegalia
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
1.35
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
Rhizodontidae
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
Tristichopteridae
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
1.32
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Stacked plots with viridis color scale</span>
<span class="fu"><a href="../reference/clockrate_dens_plot.html">clockrate_dens_plot</a></span><span class="op">(</span><span class="va">rate_table_clades_means1</span>, stack <span class="op">=</span> <span class="cn">TRUE</span>,
                    nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="selection-strength-mode">Selection strength (mode)<a class="anchor" aria-label="anchor" href="#selection-strength-mode"></a>
</h2>
<p>In this section, we will use evolutionary rate based inference of selection strength (or mode), as first introduced by <span class="citation">Baker et al. (<a href="#ref-baker2016" role="doc-biblioref">2016</a>)</span> for continuous traits, and later adapted to clock-based rates by <span class="citation">Simões and Pierce (<a href="#ref-sim%C3%B5es2021" role="doc-biblioref">2021</a>)</span>.</p>
<div class="section level3">
<h3 id="import-and-transform-table">1. Import and transform table<a class="anchor" aria-label="anchor" href="#import-and-transform-table"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import rate table with clade membership (new "clade" column added) </span>
<span class="co">## from your local directory with "mean" values</span>
<span class="va">rate_table_clades_means3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"RateTable_Means3_Clades.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Below, we use the rate table with clade membership <code>rate_table_clades_means3</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span><span class="op">)</span></code></pre></div>
<p>It is necessary to transform the table from wide to long format with <code><a href="../reference/clock_reshape.html">clock_reshape()</a></code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Transform table from wide to long format</span>
<span class="va">rates_by_clade</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clock_reshape.html">clock_reshape</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="import-combined-log-file-from-all-runs-">2. Import combined log file from all runs.<a class="anchor" aria-label="anchor" href="#import-combined-log-file-from-all-runs-"></a>
</h3>
<p>This is produced by using <code><a href="../reference/combine_log.html">combine_log()</a></code>. Alternatively, users can also use <strong>LogCombiner</strong> from the <a href="https://www.beast2.org/beagle-beast-2-in-cluster/index.html" class="external-link">BEAST2</a> software package. The first argument passed to <code><a href="../reference/combine_log.html">combine_log()</a></code> should be a path to the folder containing the log files to be imported and combined.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Import all log (.p) files from all runs and combine them, with burn-in = 25% </span>
<span class="co">## and downsampling to 2.5k trees in each log file</span>
<span class="va">posterior3p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_log.html">combine_log</a></span><span class="op">(</span><span class="st">"LogFiles3p"</span>, burnin <span class="op">=</span> <span class="fl">0.25</span>, downsample <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>Below, we use the posterior dataset <code>posterior3p</code> that accompanies <code>EvoPhylo</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">posterior3p</span><span class="op">)</span>

<span class="co">## Show first 10 lines of combined log file</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">posterior3p</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pairwise-t-tests-of-rate-values">3. Pairwise t-tests of Rate values<a class="anchor" aria-label="anchor" href="#pairwise-t-tests-of-rate-values"></a>
</h3>
<p>The function <code><a href="../reference/get_pwt_rates.html">get_pwt_rates()</a></code> will produce a table of pairwise t-tests for differences between the mean clockrate value in the posterior and the absolute rate for each tree node.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get table of pairwise t-tests for difference between the posterior </span>
<span class="co">## mean and the rate for each tree node</span>
<span class="va">rate_sign_tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_pwt_rates.html">get_pwt_rates</a></span><span class="op">(</span><span class="va">rate_table_clades_means3</span>, <span class="va">posterior3p</span><span class="op">)</span>

<span class="co">## Show first 10 lines of table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rate_sign_tests</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Combined log file
</caption>
<thead><tr>
<th style="text-align:left;">
clade
</th>
<th style="text-align:right;">
nodes
</th>
<th style="text-align:left;">
clock
</th>
<th style="text-align:right;">
relative rate
</th>
<th style="text-align:right;">
absolute rate (mean)
</th>
<th style="text-align:right;">
null
</th>
<th style="text-align:right;">
p.value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.943696
</td>
<td style="text-align:right;">
0.0118443
</td>
<td style="text-align:right;">
0.0118443
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1.065326
</td>
<td style="text-align:right;">
0.0133709
</td>
<td style="text-align:right;">
0.0133709
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1.182460
</td>
<td style="text-align:right;">
0.0148411
</td>
<td style="text-align:right;">
0.0148411
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1.229767
</td>
<td style="text-align:right;">
0.0154348
</td>
<td style="text-align:right;">
0.0154348
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Dipnomorpha
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1.230564
</td>
<td style="text-align:right;">
0.0154448
</td>
<td style="text-align:right;">
0.0154448
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.658855
</td>
<td style="text-align:right;">
0.0082693
</td>
<td style="text-align:right;">
0.0082693
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Other
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.603090
</td>
<td style="text-align:right;">
0.0075694
</td>
<td style="text-align:right;">
0.0075694
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.843373
</td>
<td style="text-align:right;">
0.0105852
</td>
<td style="text-align:right;">
0.0105852
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.872012
</td>
<td style="text-align:right;">
0.0109446
</td>
<td style="text-align:right;">
0.0109446
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Osteolepididae
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.811473
</td>
<td style="text-align:right;">
0.0101848
</td>
<td style="text-align:right;">
0.0101848
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Export the table</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">rate_sign_tests</span>, file <span class="op">=</span> <span class="st">"RateSign_tests.csv"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-selection-gradient-on-the-summary-tree">4. Plot selection gradient on the summary tree<a class="anchor" aria-label="anchor" href="#plot-selection-gradient-on-the-summary-tree"></a>
</h3>
<p>Using different thresholds, Identify the strength (or mode) across branches in the tree for each clock partition with <code><a href="../reference/plot_treerates_sgn.html">plot_treerates_sgn()</a></code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot tree using various thresholds for clock partition 1</span>
<span class="va">A1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_treerates_sgn.html">plot_treerates_sgn</a></span><span class="op">(</span>
  <span class="va">tree3p</span>, <span class="va">posterior3p</span>, 
  clock <span class="op">=</span> <span class="fl">1</span>,               <span class="co">#Show rates for clock partition 1</span>
  summary <span class="op">=</span> <span class="st">"mean"</span>,        <span class="co">#sets summary stats to get from summary tree nodes</span>
  branch_size <span class="op">=</span> <span class="fl">1.5</span>, tip_size <span class="op">=</span> <span class="fl">3</span>,                      <span class="co">#sets size for tree elements</span>
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">450</span>, <span class="op">-</span><span class="fl">260</span><span class="op">)</span>, nbreaks <span class="op">=</span> <span class="fl">8</span>, geo_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,  <span class="co">#sets limits and breaks for geoscale</span>
  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 SD"</span>, <span class="st">"2 SD"</span><span class="op">)</span><span class="op">)</span>                 <span class="co">#sets threshold for selection mode</span>
<span class="va">A1</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Plot tree using various thresholds for the other clock partitions and combine them.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Plot tree using various thresholds for other clock partition and combine them</span>
<span class="va">A2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_treerates_sgn.html">plot_treerates_sgn</a></span><span class="op">(</span>
  <span class="va">tree3p</span>, <span class="va">posterior3p</span>, 
  clock <span class="op">=</span> <span class="fl">2</span>,               <span class="co">#Show rates for clock partition 2</span>
  summary <span class="op">=</span> <span class="st">"mean"</span>,        <span class="co">#sets summary stats to get from summary tree nodes</span>
  branch_size <span class="op">=</span> <span class="fl">1.5</span>, tip_size <span class="op">=</span> <span class="fl">3</span>,                      <span class="co">#sets size for tree elements</span>
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">450</span>, <span class="op">-</span><span class="fl">260</span><span class="op">)</span>, nbreaks <span class="op">=</span> <span class="fl">8</span>, geo_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,  <span class="co">#sets limits and breaks for geoscale</span>
  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 SD"</span>, <span class="st">"2 SD"</span><span class="op">)</span><span class="op">)</span>                 <span class="co">#sets threshold for selection mode</span>

<span class="va">A3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_treerates_sgn.html">plot_treerates_sgn</a></span><span class="op">(</span>
  <span class="va">tree3p</span>, <span class="va">posterior3p</span>, 
  clock <span class="op">=</span> <span class="fl">3</span>,               <span class="co">#Show rates for clock partition 2</span>
  summary <span class="op">=</span> <span class="st">"mean"</span>,        <span class="co">#sets summary stats to get from summary tree nodes</span>
  branch_size <span class="op">=</span> <span class="fl">1.5</span>, tip_size <span class="op">=</span> <span class="fl">3</span>,                      <span class="co">#sets size for tree elements</span>
  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">450</span>, <span class="op">-</span><span class="fl">260</span><span class="op">)</span>, nbreaks <span class="op">=</span> <span class="fl">8</span>, geo_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,  <span class="co">#sets limits and breaks for geoscale</span>
  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 SD"</span>, <span class="st">"2 SD"</span><span class="op">)</span><span class="op">)</span>                 <span class="co">#sets threshold for selection mode</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>
<span class="va">A1</span> <span class="op">+</span> <span class="va">A2</span> <span class="op">+</span> <span class="va">A3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="rates-selection_files/figure-html/unnamed-chunk-34-1.png" width="100%"></p>
<pre class="eval"><code><span class="co">## Save your plot to your working directory as a PDF</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Tree_Sel_3p.pdf"</span>, width <span class="op">=</span> <span class="fl">20</span>, height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-baker2016">
<p>Baker, Joanna, Andrew Meade, Mark Pagel, and Chris Venditti. 2016. “Positive Phenotypic Selection Inferred from Phylogenies.” <em>Biological Journal of the Linnean Society</em> 118 (1): 95–115.</p>
</div>
<div id="ref-simões2021">
<p>Simões, Tiago R., and Stephanie E. Pierce. 2021. “Sustained High Rates of Morphological Evolution During the Rise of Tetrapods.” <em>Nature Ecology &amp; Evolution</em> 5 (10): 1403–14. <a href="https://doi.org/10.1038/s41559-021-01532-x" class="external-link">https://doi.org/10.1038/s41559-021-01532-x</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tiago Simoes, Noah Greifer, Stephanie Pierce.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
